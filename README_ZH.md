# LWDrawboard

[![CI Status](https://img.shields.io/travis/luowei/LWDrawboard.svg?style=flat)](https://travis-ci.org/luowei/LWDrawboard)
[![Version](https://img.shields.io/cocoapods/v/LWDrawboard.svg?style=flat)](https://cocoapods.org/pods/LWDrawboard)
[![License](https://img.shields.io/cocoapods/l/LWDrawboard.svg?style=flat)](https://cocoapods.org/pods/LWDrawboard)
[![Platform](https://img.shields.io/cocoapods/p/LWDrawboard.svg?style=flat)](https://cocoapods.org/pods/LWDrawboard)

## ç®€ä»‹

LWDrawboard æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ iOS ç”»æ¿å’Œæ¶‚é¸¦æ¿åº“ï¼Œæ”¯æŒè‡ªå®šä¹‰ç¬”è§¦å¤§å°å’Œé¢œè‰²ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„ç»˜å›¾å·¥å…·å’ŒåŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š

- å¯è‡ªå®šä¹‰ç¬”è§¦å¤§å°å’Œé¢œè‰²çš„è‡ªç”±ç»˜ç”»
- ç»˜åˆ¶çŸ©å½¢ã€åœ†å½¢ã€å¤šè¾¹å½¢ã€ç®­å¤´ç­‰å‡ ä½•å›¾å½¢
- æ–‡å­—è¾“å…¥å’Œç¼–è¾‘ï¼Œæ”¯æŒå¤šç§å­—ä½“æ ·å¼
- é©¬èµ›å…‹æ•ˆæœ
- å›¾ç‰‡è£å‰ªåŠŸèƒ½
- æ¯›ç¬”å­—æ•ˆæœç¬”åˆ·
- æ‰‹å†™è¾“å…¥æ”¯æŒ
- è¡¨æƒ…ç¬¦å·å’Œå›¾ç‰‡è´´çº¸
- æ©¡çš®æ“¦åŠŸèƒ½
- é˜´å½±æ•ˆæœæ”¯æŒ

## åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

- **å¤šç§ç»˜å›¾å·¥å…·**
  - è‡ªç”±ç”»ç¬”ï¼ˆHandï¼‰
  - æ©¡çš®æ“¦ï¼ˆEraseï¼‰
  - ç›´çº¿ï¼ˆLineï¼‰
  - ç®­å¤´ï¼ˆLineArrowï¼‰
  - çŸ©å½¢ï¼ˆRectangleã€RectangleDashã€RectangleFillï¼‰
  - åœ†å½¢/æ¤­åœ†ï¼ˆOvalã€OvalDashã€OvalFillï¼‰
  - è™šçº¿ï¼ˆLineDashã€CurveDashï¼‰
  - æ¯›ç¬”ï¼ˆChinesePenï¼‰

- **æ–‡æœ¬å’Œè´´çº¸**
  - æ–‡å­—è¾“å…¥å’Œç¼–è¾‘ï¼ˆTextï¼‰
  - å¤šç§å­—ä½“æ”¯æŒï¼ˆåŒ…æ‹¬ Helveticaã€PingFangã€STFangsong ç­‰ï¼‰
  - è¡¨æƒ…ç¬¦å·è´´çº¸ï¼ˆEmojiTileï¼‰
  - å›¾ç‰‡è´´çº¸ï¼ˆImageTileï¼‰

- **é«˜çº§åŠŸèƒ½**
  - å¯è°ƒèŠ‚ç¬”è§¦å®½åº¦ï¼ˆ5-13ptï¼‰
  - è‡ªå®šä¹‰é¢œè‰²é€‰æ‹©å™¨ï¼ˆ18 ç§é¢„è®¾é¢œè‰²ï¼‰
  - èƒŒæ™¯å›¾ç‰‡å’ŒèƒŒæ™¯é¢œè‰²è®¾ç½®
  - é˜´å½±æ•ˆæœå¼€å…³
  - å›¾å½¢æ—‹è½¬å’Œç¼©æ”¾
  - æ’¤é”€/é‡åšåŠŸèƒ½
  - ä¿å­˜ä¸ºå›¾ç‰‡

### ä¸“ä¸šç‰¹æ€§

- **AFBrushBoard** - æ¯›ç¬”å­—æ•ˆæœç¬”åˆ·æ¿ï¼Œå®ç°çœŸå®çš„æ¯›ç¬”ä¹¦å†™æ•ˆæœ
- **LWHandwrittingView** - æ‰‹å†™è¾“å…¥è§†å›¾ï¼Œæ”¯æŒæ‰‹å†™è¯†åˆ«å’Œè·¯å¾„è¿½è¸ª
- **LWDrawView** - ä¸»ç»˜å›¾è§†å›¾ï¼Œæ”¯æŒå¤šç§ç»˜å›¾æ¨¡å¼å’Œç¼–è¾‘åŠŸèƒ½

## ç³»ç»Ÿè¦æ±‚

- iOS 8.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- Xcode 9.0+
- Swift 4.0+ / Objective-C

## å®‰è£…

### CocoaPods

LWDrawboard å¯ä»¥é€šè¿‡ [CocoaPods](https://cocoapods.org) è¿›è¡Œå®‰è£…ã€‚åœ¨ä½ çš„ Podfile ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```ruby
pod 'LWDrawboard'
```

ç„¶åè¿è¡Œï¼š

```bash
pod install
```

### Carthage

åœ¨ä½ çš„ Cartfile ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```ruby
github "luowei/LWDrawboard"
```

ç„¶åè¿è¡Œï¼š

```bash
carthage update
```

## ä½¿ç”¨æ–¹æ³•

### ç¤ºä¾‹é¡¹ç›®

è¦è¿è¡Œç¤ºä¾‹é¡¹ç›®ï¼Œè¯·å…ˆå…‹éš†ä»“åº“ï¼Œç„¶ååœ¨ Example ç›®å½•ä¸‹è¿è¡Œ `pod install`ã€‚

ç¤ºä¾‹é¡¹ç›®åŒ…å«äº†ä¸¤ä¸ªä¸»è¦çš„ä½¿ç”¨ç¤ºä¾‹ï¼š
- `LWBrushBoardViewController` - æ¼”ç¤ºæ¯›ç¬”æ¿çš„ä½¿ç”¨
- `LWHandwrittingViewController` - æ¼”ç¤ºæ‰‹å†™è¾“å…¥çš„ä½¿ç”¨

### åŸºæœ¬ä½¿ç”¨

#### 1. åˆ›å»ºæ¯›ç¬”ç”»æ¿ï¼ˆAFBrushBoardï¼‰

```objective-c
#import <LWDrawboard/AFBrushBoard.h>

// åˆ›å»ºæ¯›ç¬”ç”»æ¿
AFBrushBoard *brushBoard = [[AFBrushBoard alloc] initWithFrame:CGRectMake(0, 0, 300, 400)];

// è®¾ç½®ç¬”è§¦é¢œè‰²
brushBoard.penColor = [UIColor blackColor];

// è®¾ç½®ç¬”è§¦å®½åº¦ï¼ˆé»˜è®¤ä¸º 13ï¼‰
brushBoard.penWidth = 10;

// æ·»åŠ åˆ°è§†å›¾
[self.view addSubview:brushBoard];

// æ¸…ç©ºç”»æ¿
[brushBoard cleanDrawImage];
```

#### 2. åˆ›å»ºæ‰‹å†™è¾“å…¥è§†å›¾ï¼ˆLWHandwrittingViewï¼‰

```objective-c
#import <LWDrawboard/LWHandwrittingView.h>

// åˆ›å»ºæ‰‹å†™è¾“å…¥è§†å›¾
LWHandwrittingView *handwritingView = [LWHandwrittingView handwrittingViewWithFrame:self.view.bounds
                                                                             delegate:self];

// è®¾ç½®çº¿æ¡é¢œè‰²
handwritingView.lineColor = [UIColor blueColor];

// è®¾ç½®çº¿æ¡å®½åº¦
handwritingView.lineWidth = 2.0;

// æ·»åŠ åˆ°è§†å›¾
[self.view addSubview:handwritingView];
```

å®ç°ä»£ç†æ–¹æ³•ï¼š

```objective-c
#pragma mark - LWHandwrittingViewProtocol

- (void)touchMovedWithPoint:(CGPoint)touchPoint pathPoints:(NSMutableArray *)pathPoints {
    // è§¦æ‘¸ç§»åŠ¨æ—¶çš„å›è°ƒ
    NSLog(@"Touch moved at: %@", NSStringFromCGPoint(touchPoint));
}

- (void)touchMoveEndWithPoint:(CGPoint)touchPoint pathPoints:(NSMutableArray *)pathPoints {
    // è§¦æ‘¸ç»“æŸæ—¶çš„å›è°ƒ
    NSLog(@"Touch ended at: %@", NSStringFromCGPoint(touchPoint));
}

- (void)touchCancelledWithPathPoints:(NSMutableArray *)pathPoints {
    // è§¦æ‘¸å–æ¶ˆæ—¶çš„å›è°ƒ
    NSLog(@"Touch cancelled");
}
```

#### 3. åˆ›å»ºå®Œæ•´çš„ç»˜å›¾è§†å›¾ï¼ˆLWDrawViewï¼‰

```objective-c
#import <LWDrawboard/LWDrawView.h>
#import <LWDrawboard/LWDrawBar.h>

// åˆ›å»ºç»˜å›¾è§†å›¾
LWDrawView *drawView = [LWDrawView drawViewWithDelegate:self];
drawView.frame = CGRectMake(0, 0, self.view.bounds.size.width, self.view.bounds.size.height - 60);

// è®¾ç½®èƒŒæ™¯é¢œè‰²
drawView.backgroundFillColor = [UIColor whiteColor];

// è®¾ç½®ç»˜å›¾ç±»å‹
drawView.drawType = Hand; // è‡ªç”±ç”»ç¬”

// è®¾ç½®ç”»ç¬”é¢œè‰²
drawView.freeInkColor = [UIColor blackColor];

// è®¾ç½®ç”»ç¬”çº¿å®½
drawView.freeInkLinewidth = 3.0;

// å¼€å¯é˜´å½±æ•ˆæœ
drawView.openShadow = YES;

// å¯ç”¨ç¼–è¾‘åŠŸèƒ½
drawView.enableEdit = YES;

// æ·»åŠ åˆ°è§†å›¾
[self.view addSubview:drawView];

// åˆ›å»ºå·¥å…·æ 
LWDrawBar *drawBar = [LWDrawBar drawBarWithFrame:CGRectMake(0, self.view.bounds.size.height - 60,
                                                              self.view.bounds.size.width, 60)];
[self.view addSubview:drawBar];
```

### é«˜çº§åŠŸèƒ½

#### åˆ‡æ¢ç»˜å›¾å·¥å…·

```objective-c
// åˆ‡æ¢ä¸ºæ©¡çš®æ“¦æ¨¡å¼
drawView.drawType = Erase;

// åˆ‡æ¢ä¸ºçŸ©å½¢å·¥å…·
drawView.drawType = Rectangle;

// åˆ‡æ¢ä¸ºåœ†å½¢å·¥å…·
drawView.drawType = Oval;

// åˆ‡æ¢ä¸ºç®­å¤´å·¥å…·
drawView.drawType = LineArrow;

// åˆ‡æ¢ä¸ºæ–‡å­—å·¥å…·
drawView.drawType = Text;

// åˆ‡æ¢ä¸ºæ¯›ç¬”å·¥å…·
drawView.drawType = ChinesePen;
drawView.chinesePenWidth = 13.0;
```

#### é‡ç½®å’Œæ¸…ç©ºç”»æ¿

```objective-c
// é‡ç½®ç”»æ¿ï¼ˆæ¸…ç©ºæ‰€æœ‰å†…å®¹ï¼‰
[drawView resetDrawing];

// é€€å‡ºç¼–è¾‘æˆ–æ–‡æœ¬è¾“å…¥çŠ¶æ€
[drawView exitEditingOrTexting];
```

#### è®¾ç½®å­—ä½“

```objective-c
// è®¾ç½®æ–‡å­—å­—ä½“
drawView.fontName = @"PingFangSC-Regular";
```

#### æ·»åŠ è¡¨æƒ…ç¬¦å·æˆ–å›¾ç‰‡è´´çº¸

```objective-c
// æ·»åŠ è¡¨æƒ…ç¬¦å·
drawView.drawType = EmojiTile;
drawView.tileEmojiText = @"ğŸ˜€";

// æ·»åŠ å›¾ç‰‡è´´çº¸ï¼ˆéœ€è¦å®ç°ä»£ç†æ–¹æ³•ï¼‰
drawView.drawType = ImageTile;
drawView.tileAsset = photoAsset; // PHAsset å¯¹è±¡
```

å®ç°å›¾ç‰‡è¯·æ±‚ä»£ç†æ–¹æ³•ï¼š

```objective-c
#pragma mark - LWDrawViewProtocol

- (void)requestTileImageForAsset:(PHAsset *)tileAsset
                            size:(CGSize)size
                      completion:(void (^)(UIImage *, NSDictionary *))completion {
    // ä»ç›¸å†Œè·å–å›¾ç‰‡
    PHImageManager *manager = [PHImageManager defaultManager];
    PHImageRequestOptions *options = [[PHImageRequestOptions alloc] init];
    options.synchronous = NO;
    options.deliveryMode = PHImageRequestOptionsDeliveryModeHighQualityFormat;

    [manager requestImageForAsset:tileAsset
                       targetSize:size
                      contentMode:PHImageContentModeAspectFit
                          options:options
                    resultHandler:^(UIImage *result, NSDictionary *info) {
        if (completion) {
            completion(result, info);
        }
    }];
}
```

## API æ–‡æ¡£

### AFBrushBoard

æ¯›ç¬”å­—æ•ˆæœç¬”åˆ·æ¿ã€‚

#### å±æ€§

- `penColor` (UIColor *) - ç¬”è§¦é¢œè‰²
- `penWidth` (CGFloat) - ç¬”è§¦å®½åº¦ï¼Œé»˜è®¤å€¼ä¸º 13

#### æ–¹æ³•

- `- (void)cleanDrawImage` - æ¸…ç©ºç”»æ¿å†…å®¹

---

### LWHandwrittingView

æ‰‹å†™è¾“å…¥è§†å›¾ï¼Œæ”¯æŒæ‰‹å†™è¯†åˆ«å’Œè·¯å¾„è¿½è¸ªã€‚

#### å±æ€§

- `delegate` (id<LWHandwrittingViewProtocol>) - ä»£ç†å¯¹è±¡
- `pathes` (NSMutableArray *) - ç»˜åˆ¶è·¯å¾„æ•°ç»„
- `lineWidth` (CGFloat) - çº¿æ¡å®½åº¦
- `lineColor` (UIColor *) - çº¿æ¡é¢œè‰²

#### æ–¹æ³•

- `+ (instancetype)handwrittingViewWithFrame:(CGRect)frame delegate:(id<LWHandwrittingViewProtocol>)delegate` - åˆ›å»ºæ‰‹å†™è¾“å…¥è§†å›¾

#### ä»£ç†æ–¹æ³•ï¼ˆLWHandwrittingViewProtocolï¼‰

```objective-c
@optional
- (void)touchMovedWithPoint:(CGPoint)touchPoint pathPoints:(NSMutableArray *)pathPoints;
- (void)touchMoveEndWithPoint:(CGPoint)touchPoint pathPoints:(NSMutableArray *)pathPoints;
- (void)touchCancelledWithPathPoints:(NSMutableArray *)pathPoints;
```

---

### LWDrawView

ä¸»ç»˜å›¾è§†å›¾ï¼Œæä¾›å®Œæ•´çš„ç»˜å›¾å’Œç¼–è¾‘åŠŸèƒ½ã€‚

#### å±æ€§

##### ç»˜å›¾è®¾ç½®
- `drawType` (DrawType) - å½“å‰ç»˜å›¾å·¥å…·ç±»å‹
- `freeInkColor` (UIColor *) - è‡ªç”±ç”»ç¬”é¢œè‰²
- `freeInkLinewidth` (CGFloat) - è‡ªç”±ç”»ç¬”çº¿å®½
- `chinesePenWidth` (CGFloat) - æ¯›ç¬”ç¬”å®½

##### èƒŒæ™¯è®¾ç½®
- `backgroundImage` (UIImage *) - èƒŒæ™¯å›¾ç‰‡
- `backgroundFillColor` (UIColor *) - èƒŒæ™¯é¢œè‰²

##### åŠŸèƒ½å¼€å…³
- `enableEdit` (BOOL) - æ˜¯å¦å¯ç”¨ç¼–è¾‘åŠŸèƒ½
- `openShadow` (BOOL) - æ˜¯å¦å¼€å¯é˜´å½±æ•ˆæœ
- `drawStatus` (DrawStatus) - å½“å‰ç»˜å›¾çŠ¶æ€ï¼ˆDrawing/Editing/Textingï¼‰

##### æ–‡å­—å’Œè´´çº¸
- `fontName` (NSString *) - æ–‡å­—å­—ä½“åç§°
- `tileEmojiText` (NSString *) - è¡¨æƒ…ç¬¦å·æ–‡æœ¬
- `tileAsset` (PHAsset *) - å›¾ç‰‡èµ„æº

##### å†…éƒ¨ç»„ä»¶
- `curves` (NSMutableArray *) - æ›²çº¿é›†åˆ
- `textView` (LWScratchTextView *) - æ–‡æœ¬è¾“å…¥æ¡†
- `controlView` (LWControlView *) - æ§åˆ¶æ¡†

#### æ–¹æ³•

- `+ (instancetype)drawViewWithDelegate:(id<LWDrawViewProtocol>)delegate` - åˆ›å»ºç»˜å›¾è§†å›¾
- `- (void)resetDrawing` - é‡ç½®ç”»æ¿ï¼ˆæ¸…ç©ºæ‰€æœ‰å†…å®¹ï¼‰
- `- (void)exitEditingOrTexting` - é€€å‡ºç¼–è¾‘æˆ–æ–‡æœ¬è¾“å…¥çŠ¶æ€

#### ä»£ç†æ–¹æ³•ï¼ˆLWDrawViewProtocolï¼‰

```objective-c
@optional
- (void)requestTileImageForAsset:(PHAsset *)tileAsset
                            size:(CGSize)size
                      completion:(void (^)(UIImage *, NSDictionary *))completion;
```

---

### LWDrawBar

ç»˜å›¾å·¥å…·æ ã€‚

#### æ–¹æ³•

- `+ (LWDrawBar *)drawBarWithFrame:(CGRect)frame` - åˆ›å»ºå·¥å…·æ 

---

### DrawType æšä¸¾

ç»˜åˆ¶å·¥å…·ç±»å‹ï¼š

```objective-c
typedef NS_OPTIONS(NSUInteger, DrawType) {
    Hand = 1,                // è‡ªç”±ç”»ç¬”
    Erase = 1 << 1,         // æ©¡çš®æ“¦
    Line = 1 << 2,          // ç›´çº¿
    LineArrow = 1 << 3,     // ç®­å¤´
    Rectangle = 1 << 4,     // çŸ©å½¢
    Oval = 1 << 5,          // æ¤­åœ†
    Text = 1 << 6,          // æ–‡å­—
    EmojiTile = 1 << 7,     // è¡¨æƒ…ç¬¦å·è´´çº¸
    ImageTile = 1 << 8,     // å›¾ç‰‡è´´çº¸
    RectangleDash = 1 << 9, // è™šçº¿çŸ©å½¢
    RectangleFill = 1 << 10,// å¡«å……çŸ©å½¢
    OvalDash = 1 << 11,     // è™šçº¿æ¤­åœ†
    OvalFill = 1 << 12,     // å¡«å……æ¤­åœ†
    LineDash = 1 << 13,     // è™šçº¿
    CurveDash = 1 << 14,    // è™šçº¿æ›²çº¿
    ChinesePen = 1 << 15,   // æ¯›ç¬”
};
```

### DrawStatus æšä¸¾

ç»˜å›¾çŠ¶æ€ï¼š

```objective-c
typedef NS_OPTIONS(NSUInteger, DrawStatus) {
    Drawing = 1,   // ç»˜åˆ¶æ¨¡å¼
    Editing = 2,   // ç¼–è¾‘æ¨¡å¼
    Texting = 3,   // æ–‡æœ¬è¾“å…¥æ¨¡å¼
};
```

## ä¾èµ–åº“

LWDrawboard ä¾èµ–ä»¥ä¸‹ç¬¬ä¸‰æ–¹åº“ï¼š

- [Masonry](https://github.com/SnapKit/Masonry) - è‡ªåŠ¨å¸ƒå±€åº“
- [SDWebImage](https://github.com/SDWebImage/SDWebImage) - å›¾ç‰‡åŠ è½½å’Œç¼“å­˜åº“

è¿™äº›ä¾èµ–ä¼šåœ¨é€šè¿‡ CocoaPods æˆ– Carthage å®‰è£…æ—¶è‡ªåŠ¨åŒ…å«ã€‚

## å¸¸è§é—®é¢˜

### 1. å¦‚ä½•ä¿å­˜ç”»æ¿å†…å®¹ä¸ºå›¾ç‰‡ï¼Ÿ

```objective-c
// å°†è§†å›¾å†…å®¹ä¿å­˜ä¸ºå›¾ç‰‡
UIGraphicsBeginImageContextWithOptions(drawView.bounds.size, NO, 0.0);
[drawView.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

// ä¿å­˜åˆ°ç›¸å†Œ
UIImageWriteToSavedPhotosAlbum(image, nil, nil, nil);
```

### 2. å¦‚ä½•è‡ªå®šä¹‰é¢œè‰²é€‰æ‹©å™¨ï¼Ÿ

LWDrawBar ä¸­å·²ç»å†…ç½®äº†é¢œè‰²é€‰æ‹©å™¨ï¼ŒåŒ…å« 18 ç§é¢„è®¾é¢œè‰²ã€‚å¦‚éœ€è‡ªå®šä¹‰ï¼Œå¯ä»¥ä¿®æ”¹ `DrawView_Color_Items` å®å®šä¹‰ä¸­çš„é¢œè‰²å€¼ã€‚

### 3. å¦‚ä½•æ·»åŠ è‡ªå®šä¹‰å­—ä½“ï¼Ÿ

å°†å­—ä½“æ–‡ä»¶æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼Œå¹¶åœ¨ Info.plist ä¸­æ³¨å†Œã€‚ç„¶åä½¿ç”¨å­—ä½“åç§°ï¼š

```objective-c
drawView.fontName = @"YourCustomFont-Regular";
```

### 4. æ¯›ç¬”æ•ˆæœå¦‚ä½•å®ç°ï¼Ÿ

æ¯›ç¬”æ•ˆæœæ˜¯é€šè¿‡ AFBrushBoard ç±»å®ç°çš„ï¼Œå®ƒåŸºäºè´å¡å°”æ›²çº¿å’Œè§¦æ‘¸å‹åŠ›æ¨¡æ‹ŸçœŸå®çš„æ¯›ç¬”ä¹¦å†™æ•ˆæœã€‚

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ä½œè€…

luowei, luowei@wodedata.com

## è®¸å¯è¯

LWDrawboard åŸºäº MIT è®¸å¯è¯å¼€æºã€‚è¯¦ç»†ä¿¡æ¯è¯·æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

## English Documentation

For English documentation, please refer to [README.md](README.md).
